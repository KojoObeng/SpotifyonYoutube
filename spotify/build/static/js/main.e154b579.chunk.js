(this.webpackJsonpspotify=this.webpackJsonpspotify||[]).push([[0],{32:function(e,t,a){},34:function(e,t,a){e.exports=a.p+"static/media/green-left-icon-arrow-left.9ac61d34.png"},48:function(e,t,a){e.exports=a(88)},53:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){e.exports=a.p+"static/media/spotify-youtube.df22d929.jpg"},62:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){e.exports=a.p+"static/media/dynamic.5dcecaa6.jpg"},86:function(e,t,a){e.exports=a.p+"static/media/monkey-with-headphones.ca4c559e.jpg"},87:function(e,t,a){},88:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(23),i=a.n(s),c=(a(53),a(9)),o=a(10),l=a(12),u=a(11),d=a(18),y=a(4),m=(a(26),a(92)),h=a(93),p=(a(54),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"home-page"},r.a.createElement(m.a,{className:"spotify-youtube-card"},r.a.createElement(m.a.Img,{className:"spotify-youtube-card-img",src:a(55),alt:"Spotify-Youtube"}),r.a.createElement("a",{href:"http://localhost:8888/login"},r.a.createElement(h.a,{className:"spotify-youtube-card-button"},"Login With Spotify"))))}}]),n}(n.Component)),f=a(8),g=a(20),b=a.n(g),k=a(3),v=a.n(k),_=a(14),E=(a(32),new b.a),I=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).playlistID=n.props.id,n.playlistName=n.props.name,n.numOfTracks=0,n.state={tracks:[]},n._isMounted=!1,n.loop.bind(Object(f.a)(n)),n}return Object(o.a)(a,[{key:"componentWillMount",value:function(){var e=Object(_.a)(v.a.mark((function e(){var t=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.tracks=[],e.next=3,E.getPlaylistTracks(this.playlistID).then((function(e){t.numOfTracks=e.total}));case 3:this.loop(this.numOfTracks,this.playlistID);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loop",value:function(){var e=Object(_.a)(v.a.mark((function e(t,a){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._isMounted=!0,n=0;case 2:if(!(n<Math.ceil(t/100))){e.next=10;break}return e.next=5,E.getPlaylistTracks(a,{offset:100*n}).then((function(e){return e}));case 5:r=e.sent,this.tracks.push(r);case 7:n++,e.next=2;break;case 10:this.tracks=this.tracks.map((function(e){return e.items})),this.tracks=[].concat.apply([],this.tracks),this._isMounted&&(this.setState({tracks:this.tracks.map((function(e){return{album_name:e.track.album.name,album_images:e.track.album.images,artists:e.track.artists.map((function(e){return e.name})),duration:e.track.duration_ms,track_name:e.track.name,date:e.added_at,id:e.track.id}}))}),this._isMounted=!1);case 13:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){return this.state.tracks===[]?null:r.a.createElement("div",{className:"playlist-button-and-image-container"},r.a.createElement(d.b,{to:{pathname:"/youtube",playlistID:this.playlistID,playlistName:this.playlistName,tracks:this.state.tracks}},r.a.createElement(h.a,{className:"playlist-button"},this.playlistName),r.a.createElement("img",{className:"playlist-image",src:this.props.image,alt:this.playlistName})))}}]),a}(n.Component),w=a(91),O=(a(62),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={scrollPos:window.pageYOffset,show:!0},a}return Object(o.a)(n,[{key:"render",value:function(){return r.a.createElement(w.a,{className:"navigation"},r.a.createElement(d.b,{to:"/"+this.props.back},r.a.createElement("img",{className:"navigation-back-button",src:a(34),alt:"Green Left Arrow",height:"30"})),r.a.createElement("div",null,this.props.children))}}]),n}(n.Component)),j=new b.a,N=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={playlists:[]},n.getPlaylists=n.getPlaylists.bind(Object(f.a)(n)),j.setAccessToken(localStorage.getItem("access_token")),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.getPlaylists()}},{key:"getPlaylists",value:function(){var e=this;j.getUserPlaylists().then((function(t){e.setState({playlists:t.items})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(O,{back:"modes"}," "),r.a.createElement("div",{className:"playlist-page"},r.a.createElement("div",{className:"playlists-container"},this.state.playlists.map((function(e,t){return r.a.createElement(I,{key:e.name,id:e.id,index:t,name:e.name,image:e.images[0].url})})))))}}]),a}(n.Component),S=a(46),D=a.n(S),x=a(90),P=(a(83),a(47)),C=a.n(P),T=new b.a,V=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).loadVideo=function(e){a.player=new window.YT.Player("player",{height:"720",width:"1280",videoId:e,playerVars:{controls:1,autoplay:0,disablekb:1,enablejsapi:1},events:{onReady:a.onPlayerReady,onStateChange:a.onPlayerStateChange,onError:a.onError}})},T.setAccessToken(localStorage.getItem("access_token")),a.props.location.tracks&&(localStorage.setItem("tracks",JSON.stringify(a.shuffleArray(a.props.location.tracks))),localStorage.setItem("playlist",JSON.stringify(a.props.location.playlistName)),localStorage.setItem("length",JSON.stringify(a.props.location.tracks.length))),console.log(a.props.location.tracks),a.state={apiKey:"AIzaSyAUlBPBvCwXcYNNahVcmWPKphhIs4YjaWQ",search_terms:localStorage.getItem("tracks")?JSON.parse(localStorage.getItem("tracks")).map((function(e,t){return[e.artists[0]+" - "+e.track_name,e.id,t]})):"",current_index:0,length:JSON.parse(localStorage.getItem("length")),query_IDs:Array(JSON.parse(localStorage.getItem("length"))).fill(0),lyric_IDs:Array(JSON.parse(localStorage.getItem("length"))).fill(0),lyric:!1,last_updated:0,fetching:!1},console.log(a.state.search_terms),a._isMounted=!1,a.search2=a.search2.bind(Object(f.a)(a)),a.loadVideo=a.loadVideo.bind(Object(f.a)(a)),a.handleQueueClick=a.handleQueueClick.bind(Object(f.a)(a)),a.onPlayerStateChange=a.onPlayerStateChange.bind(Object(f.a)(a)),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=Object(_.a)(v.a.mark((function e(){var t,a,n=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.search2(0,Math.min(10,this.state.length));case 2:window.YT?this.loadVideo(this.state.query_IDs[0]):((t=document.createElement("script")).src="https://www.youtube.com/iframe_api",window.onYouTubeIframeAPIReady=function(){n.loadVideo(n.state.query_IDs[0])},(a=document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,a));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"shuffleArray",value:function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}return e}},{key:"onPlayerReady",value:function(e){e.target.playVideo()}},{key:"onPlayerStateChange",value:function(e){e.data===window.YT.PlayerState.ENDED&&(console.log("YouTube Video is ENDING!!"),this.handleQueueClick(this.state.current_index+1))}},{key:"onError",value:function(e){101!==e.data&&150!==e.data||this.handleQueueClick(this.state.current_index+1)}},{key:"search2",value:function(){var e=Object(_.a)(v.a.mark((function e(t,a){var n,r,s,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.controller=new AbortController,n=this.controller.signal,r={search_terms:this.state.search_terms.slice(t,a),query_IDs:this.state.query_IDs,lyric_IDs:this.state.lyric_IDs},this.setState({fetching:!0}),this._isMounted=!0,e.next=7,fetch("http://localhost:8888/youtube_search",{method:"POST",signal:n,headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(r)});case 7:if(s=e.sent,!this._isMounted){e.next=14;break}return e.next=11,s.json();case 11:i=e.sent,this.setState({query_IDs:i.query_IDs,lyric_IDs:i.lyric_IDs,last_updated:a,fetching:!1}),this._isMounted=!1;case 14:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"search",value:function(){var e=Object(_.a)(v.a.mark((function e(t){var a,n=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t[0],D.a.get("https://www.googleapis.com/youtube/v3/search?key="+this.state.apiKey+"&q="+a+"&part=snippet&maxResults=1&type=video").then((function(e){var a=n.state.query_IDs;a[t[2]]=e.data.items[0].id.videoId,n.setState({query_IDs:a},(function(){}))})).catch((function(e){console.log(e)}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createButtons",value:function(){for(var e=this,t=[],a=this.state.current_index,n=this.state.length,s=this.state.search_terms,i=this.state.query_IDs,c=function(n){a>=n&&t.push(r.a.createElement(h.a,{onClick:function(){e.handleQueueClick(a-n)},className:"spotify-youtube-previous-button",key:a-n,disabled:0===i[a-n]},"  ",s[a-n][0]," "))},o=4;o>0;o--)c(o);t.push(r.a.createElement(h.a,{className:"spotify-youtube-current-button",key:a,disabled:0===i[a]},"  ",s[a][0],"  "));for(var l=function(a){a<n-1&&t.push(r.a.createElement(h.a,{onClick:function(){e.handleQueueClick(a)},className:"spotify-youtube-next-buttons",key:a,disabled:0===i[a]},"  ",s[a][0]," "))},u=a+1;u<a+6;u++)l(u);return t}},{key:"handleQueueClick",value:function(e){var t=this;this.setState({current_index:e,lyric:!1},(function(){console.log(t.state.current_index),t.player.loadVideoById(t.state.query_IDs[t.state.current_index])}))}},{key:"handleLyricToggleClick",value:function(){var e=this;this.setState({lyric:!this.state.lyric},(function(){e.state.lyric?e.player.loadVideoById(e.state.lyric_IDs[e.state.current_index]):e.player.loadVideoById(e.state.query_IDs[e.state.current_index])}))}},{key:"componentWillUnmount",value:function(){this.controller.abort(),this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.state.last_updated;return r.a.createElement("div",null,r.a.createElement("div",{className:"button-container"},r.a.createElement(d.b,{to:"/pickPlaylist"},r.a.createElement("img",{className:"youtube-back-button",src:a(34),alt:"Green Left Arrow",height:"30"})),r.a.createElement(h.a,{className:"youtube-lyric-button",onClick:function(){return e.handleLyricToggleClick()},disabled:0===this.state.query_IDs[this.state.current_index]},!0===this.state.lyric?"Music Video":"Lyric Video"),this.createButtons()),r.a.createElement("div",{className:"player-and-sidebar"},r.a.createElement("div",{id:"player"}),r.a.createElement("div",{className:"sidebar"}),this.state.fetching?r.a.createElement("div",{className:"typed-and-spinner"},r.a.createElement("div",null,r.a.createElement(C.a,{typedRef:function(t){e.typed=t},strings:["Loading...","Retrieving links from Youtube...","Getting HD quality links...","Getting lyric videos...","Load"],typeSpeed:30,className:"loading-typed",loop:!0})),r.a.createElement("div",null,r.a.createElement(x.a,{animation:"border",className:"loading-spinner"}))):r.a.createElement("div",null,r.a.createElement(h.a,{className:"youtube-load-more-button",key:"Load20",onClick:function(){e.search2(t,t+20)},disabled:0===this.state.query_IDs[this.state.current_index]||this.state.fetching}," Load Next 20 "),r.a.createElement(h.a,{className:"youtube-load-more-button",key:"Load50",onClick:function(){e.search2(t,t+50)},disabled:0===this.state.query_IDs[this.state.current_index]||this.state.fetching},"  Load Next 50 "),r.a.createElement(h.a,{className:"youtube-load-more-button",key:"LoadAll",onClick:function(){e.search2(t,e.state.length-1)},disabled:0===this.state.query_IDs[this.state.current_index]||this.state.fetching}," Load All Songs "))))}}]),n}(n.Component),q=Object(y.f)(V),B=(a(84),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(O,{back:""}),r.a.createElement("div",{className:"modes-page"},r.a.createElement("div",{className:"modes-container"},r.a.createElement("div",{className:"dynamic-button-and-image-container"},r.a.createElement(d.b,{to:"/dynamic"},r.a.createElement(h.a,{className:"dynamic-button"}," Dynamic "),r.a.createElement("img",{className:"dynamic-image",src:a(85),alt:""}))),r.a.createElement("div",{className:"playlist-button-and-image-container"},r.a.createElement(d.b,{to:"/pickPlaylist"},r.a.createElement(h.a,{className:"playlist-button"}," Playlist "),r.a.createElement("img",{className:"playlist-image",src:a(86),alt:""}))))))}}]),n}(n.Component)),M=(a(87),new b.a),A=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).loadVideo=function(e){n.player=new window.YT.Player("player",{height:"720",width:"1280",videoId:e,playerVars:{controls:1,autoplay:0,disablekb:1,enablejsapi:1},events:{onReady:n.onPlayerReady,onStateChange:n.onPlayerStateChange,onError:n.onError}})},n.state={lyric:!1},n.spotify_id="",n.query_IDs=[0],n.lyric_IDs=[0],n.first_video=!0,n.current_state="stopped",M.setAccessToken(localStorage.getItem("access_token")),n.is_interval=!0,n.search=n.search.bind(Object(f.a)(n)),n.loadVideo=n.loadVideo.bind(Object(f.a)(n)),n.onPlayerStateChange=n.onPlayerStateChange.bind(Object(f.a)(n)),n.handleLyricToggleClick=n.handleLyricToggleClick.bind(Object(f.a)(n)),n.checkStatus=n.checkStatus.bind(Object(f.a)(n)),n.onPlayerReady=n.onPlayerReady.bind(Object(f.a)(n)),n}return Object(o.a)(a,[{key:"componentWillUnmount",value:function(){this.controller.abort(),clearInterval(this.interval),console.log("cleared")}},{key:"componentDidMount",value:function(){var e=Object(_.a)(v.a.mark((function e(){var t=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.first_video&&M.getMyCurrentPlaybackState().then(function(){var e=Object(_.a)(v.a.mark((function e(a){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.item){e.next=8;break}return t.spotify_id=a.item.id,e.next=4,t.search([a.item.name+" - "+a.item.artists[0].name,a.item.id,0]);case 4:window.YT?t.loadVideo(t.query_IDs[0]):((n=document.createElement("script")).src="https://www.youtube.com/iframe_api",window.onYouTubeIframeAPIReady=function(){t.loadVideo(t.query_IDs[0])},(r=document.getElementsByTagName("script")[0]).parentNode.insertBefore(n,r)),t.first_video=!1,e.next=9;break;case 8:M.getMyRecentlyPlayedTracks().then(function(){var e=Object(_.a)(v.a.mark((function e(a){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.spotify_id=a.items[0].track.id,e.next=3,t.search([a.items[0].track.name+" - "+a.items[0].track.artists[0].name,a.items[0].track.id,0]);case 3:window.YT?t.loadVideo(t.query_IDs[0]):((n=document.createElement("script")).src="https://www.youtube.com/iframe_api",window.onYouTubeIframeAPIReady=function(){t.loadVideo(t.query_IDs[0])},(r=document.getElementsByTagName("script")[0]).parentNode.insertBefore(n,r)),t.first_video=!1;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.interval=setInterval((function(){t.is_interval&&t.checkStatus()}),2500);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkStatus",value:function(){var e=this;M.getMyCurrentPlaybackState().then((function(t){!0===t.shuffle_state&&(e.current_state="playing")?(document.getElementById("pause").click(),e.current_state="paused"):!1===t.shuffle_state&&(e.current_state="paused")&&(document.getElementById("play").click(),e.current_state="playing"),"context"===t.repeat_state&&(e.first_video||(e.handleLyricToggleClick(),M.setRepeat("off"))),t.item&&t.item.id!==e.spotify_id&&(e.is_interval=!1,e.spotify_id=t.item.id,e.setState({lyric:!1},Object(_.a)(v.a.mark((function a(){return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.search([t.item.name+" - "+t.item.artists[0].name,t.item.id,0]);case 2:return a.next=4,e.player.loadVideoById(e.query_IDs[0]);case 4:e.current_state="playing",e.is_interval=!0,t.is_playing&&M.pause();case 7:case"end":return a.stop()}}),a)})))))}))}},{key:"search",value:function(){var e=Object(_.a)(v.a.mark((function e(t){var a,n,r,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.controller=new AbortController,a=this.controller.signal,n={search_terms:[t],query_IDs:this.query_IDs,lyric_IDs:this.lyric_IDs},this.fetching=!0,e.next=6,fetch("http://localhost:8888/youtube_search",{method:"POST",signal:a,headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)});case 6:return r=e.sent,e.next=9,r.json();case 9:s=e.sent,this.query_IDs=s.query_IDs,this.lyric_IDs=s.lyric_IDs,this.fetching=!1,this.first_video||(this.player.loadVideoById(s.query_IDs[0]),this.current_state="playing"),this.is_interval=!0;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onPlayerReady",value:function(e){document.getElementById("pause").addEventListener("click",(function(){e.target.pauseVideo()})),document.getElementById("play").addEventListener("click",(function(){e.target.playVideo()})),e.target.playVideo()}},{key:"onPlayerStateChange",value:function(e){e.data===window.YT.PlayerState.PLAYING&&(this.current_state="playing"),e.data===window.YT.PlayerState.PAUSED&&(this.current_state="paused"),e.data===window.YT.PlayerState.ENDED&&this.player.loadVideoById(this.query_IDs[0])}},{key:"onError",value:function(e){101===e.data||e.data}},{key:"handleLyricToggleClick",value:function(){var e=this;this.setState({lyric:!this.state.lyric},(function(){e.state.lyric?e.player.loadVideoById(e.lyric_IDs[0]):e.player.loadVideoById(e.query_IDs[0])}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(O,{back:"modes"},r.a.createElement(h.a,{className:"dynamic-lyric-button",onClick:function(){return e.handleLyricToggleClick()}},this.state.lyric?"Music Video":"Lyric Video")),r.a.createElement("div",{className:"player-container"},r.a.createElement("div",{id:"player"}," "),r.a.createElement(h.a,{id:"pause",className:"invisible"},"Pause"),r.a.createElement(h.a,{id:"play",className:"invisible"},"Play")))}}]),a}(n.Component),L=new b.a,Y=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).params=n.getHashParams(),n.state={loggedIn:!!n.params.access_token},n.params.access_token&&(L.setAccessToken(n.params.access_token),localStorage.setItem("access_token",n.params.access_token)),n}return Object(o.a)(a,[{key:"getHashParams",value:function(){for(var e,t={},a=/([^&;=]+)=?([^&;]*)/g,n=window.location.hash.substring(1);e=a.exec(n);)t[e[1]]=decodeURIComponent(e[2]);return t}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(d.a,null,r.a.createElement(y.c,null,r.a.createElement(y.a,{path:"/modes",component:B}),r.a.createElement(y.a,{path:"/youtube",component:q}),r.a.createElement(y.a,{path:"/dynamic",component:A}),r.a.createElement(y.a,{path:"/pickPlaylist",component:N}),r.a.createElement(y.a,{path:"/",component:p}))))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[48,1,2]]]);
//# sourceMappingURL=main.e154b579.chunk.js.map